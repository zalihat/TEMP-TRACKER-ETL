[2025-01-13T15:16:08.576+0000] {processor.py:186} INFO - Started process (PID=56) to work on /opt/airflow/dags/weather_etl_dag.py
[2025-01-13T15:16:08.577+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/weather_etl_dag.py for tasks to queue
[2025-01-13T15:16:08.581+0000] {logging_mixin.py:190} INFO - [2025-01-13T15:16:08.580+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/weather_etl_dag.py
[2025-01-13T15:16:11.827+0000] {logging_mixin.py:190} INFO - {'message': 'Invalid API key. Go to https://docs.rapidapi.com/docs/keys for more info.'}
[2025-01-13T15:16:11.871+0000] {logging_mixin.py:190} INFO - [2025-01-13T15:16:11.847+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/weather_etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3791, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 152, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 181, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'location.localtime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 999, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_etl_dag.py", line 11, in <module>
    from tasks.extract import extract_weather_data
  File "/opt/airflow/tasks/extract.py", line 50, in <module>
    extract_weather_data()
  File "/opt/airflow/tasks/extract.py", line 37, in extract_weather_data
    json_df['date'] = pd.to_datetime(json_df['location.localtime']).dt.date
                                    ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/frame.py", line 3893, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3798, in get_loc
    raise KeyError(key) from err
KeyError: 'location.localtime'
[2025-01-13T15:16:11.888+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_etl_dag.py
[2025-01-13T15:16:11.935+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/weather_etl_dag.py took 3.368 seconds
[2025-01-13T15:16:42.345+0000] {processor.py:186} INFO - Started process (PID=78) to work on /opt/airflow/dags/weather_etl_dag.py
[2025-01-13T15:16:42.346+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/weather_etl_dag.py for tasks to queue
[2025-01-13T15:16:42.349+0000] {logging_mixin.py:190} INFO - [2025-01-13T15:16:42.349+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/weather_etl_dag.py
[2025-01-13T15:16:43.812+0000] {logging_mixin.py:190} INFO - {'message': 'Invalid API key. Go to https://docs.rapidapi.com/docs/keys for more info.'}
[2025-01-13T15:16:43.821+0000] {logging_mixin.py:190} INFO - [2025-01-13T15:16:43.813+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/weather_etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3791, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 152, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 181, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'location.localtime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 999, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_etl_dag.py", line 11, in <module>
    from tasks.extract import extract_weather_data
  File "/opt/airflow/tasks/extract.py", line 50, in <module>
    extract_weather_data()
  File "/opt/airflow/tasks/extract.py", line 37, in extract_weather_data
    json_df['date'] = pd.to_datetime(json_df['location.localtime']).dt.date
                                    ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/frame.py", line 3893, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3798, in get_loc
    raise KeyError(key) from err
KeyError: 'location.localtime'
[2025-01-13T15:16:43.822+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_etl_dag.py
[2025-01-13T15:16:43.854+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/weather_etl_dag.py took 1.517 seconds
[2025-01-13T15:17:14.055+0000] {processor.py:186} INFO - Started process (PID=80) to work on /opt/airflow/dags/weather_etl_dag.py
[2025-01-13T15:17:14.056+0000] {processor.py:914} INFO - Processing file /opt/airflow/dags/weather_etl_dag.py for tasks to queue
[2025-01-13T15:17:14.059+0000] {logging_mixin.py:190} INFO - [2025-01-13T15:17:14.058+0000] {dagbag.py:588} INFO - Filling up the DagBag from /opt/airflow/dags/weather_etl_dag.py
[2025-01-13T15:17:15.371+0000] {logging_mixin.py:190} INFO - {'message': 'Invalid API key. Go to https://docs.rapidapi.com/docs/keys for more info.'}
[2025-01-13T15:17:15.380+0000] {logging_mixin.py:190} INFO - [2025-01-13T15:17:15.372+0000] {dagbag.py:387} ERROR - Failed to import: /opt/airflow/dags/weather_etl_dag.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3791, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 152, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 181, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'location.localtime'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 383, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 999, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/opt/airflow/dags/weather_etl_dag.py", line 11, in <module>
    from tasks.extract import extract_weather_data
  File "/opt/airflow/tasks/extract.py", line 50, in <module>
    extract_weather_data()
  File "/opt/airflow/tasks/extract.py", line 37, in extract_weather_data
    json_df['date'] = pd.to_datetime(json_df['location.localtime']).dt.date
                                    ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/frame.py", line 3893, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3798, in get_loc
    raise KeyError(key) from err
KeyError: 'location.localtime'
[2025-01-13T15:17:15.382+0000] {processor.py:927} WARNING - No viable dags retrieved from /opt/airflow/dags/weather_etl_dag.py
[2025-01-13T15:17:15.406+0000] {processor.py:208} INFO - Processing /opt/airflow/dags/weather_etl_dag.py took 1.358 seconds
